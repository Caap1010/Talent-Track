<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>TalentTrack ‚Äì Applications</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../../css/styles.css" />
</head>

<body data-theme="dark">
    <header class="tt-header">
        <div class="tt-header-left">
            <img src="../../img/logo.png" alt="TalentTrack logo" class="tt-logo" />
            <span class="tt-brand-name">TALENTTRACK</span>
        </div>
        <nav class="tt-nav">
            <a href="../../index.html">Home</a>
            <a href="../../jobs.html">Jobs</a>
            <a href="../../freelance.html">Freelance</a>
            <a href="../../auth.html">Login</a>
            <a href="../../register.html" class="tt-btn tt-btn-primary tt-btn-sm">Sign Up</a>
        </nav>
        <button id="darkModeToggle" class="tt-toggle" aria-label="Toggle dark mode">üåô</button>
    </header>

    <main class="tt-dashboard">
        <aside class="tt-sidebar">
            <div class="tt-sidebar-profile">
                <div class="tt-avatar">SQ</div>
                <div>
                    <h2>My Applications</h2>
                    <p>Track your job applications</p>
                </div>
            </div>
            <nav class="tt-sidebar-nav">
                <a href="candidate.html">üè† Home</a>
                <a href="applications.html" class="active">üì® Applications</a>
                <a href="me.html">üë§ Me</a>
                <a href="academy.html">üéì Academy</a>
            </nav>
        </aside>

        <section class="tt-dashboard-main">
            <div class="tt-card">
                <div class="tt-card-header">
                    <h3>Your Applications</h3>
                    <span class="tt-chip">Local</span>
                </div>
                <div class="tt-card-section">
                    <ul id="ttApplicationsPageList" class="tt-list">
                        <li class="tt-muted">No applications yet.</li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <footer class="tt-footer">
        <div class="tt-footer-left">
            <p>¬© <span id="year"></span> TalentTrack. All rights reserved.</p>
            <a href="#about">About</a>
            <a href="#contact">Contact</a>
            <a href="#privacy">Privacy Policy</a>
            <a href="#terms">Terms</a>
        </div>
        <div class="tt-footer-right"><span>üîó</span><span>üê¶</span><span>üì∑</span></div>
    </footer>

    <script>
        (function () {
            function renderApps() {
                const list = document.getElementById('ttApplicationsPageList');
                const apps = JSON.parse(localStorage.getItem('TT_APPLICATIONS') || '[]');
                if (!apps.length) {
                    list.innerHTML = '<li class="tt-muted">No applications yet.</li>';
                    return;
                }
                list.innerHTML = '';
                const appsRev = apps.slice().reverse();
                appsRev.forEach((a, revIdx) => {
                    const origIdx = apps.length - 1 - revIdx;
                    const li = document.createElement('li');
                    li.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center;"><div><strong>${a.title}</strong><p class="tt-job-meta">Applied: ${new Date(a.date).toLocaleString()}</p></div><div><button class="tt-btn tt-btn-ghost tt-btn-sm tt-withdraw" data-idx="${origIdx}">Withdraw</button></div></div>`;
                    list.appendChild(li);
                });

                // attach withdraw handlers
                list.querySelectorAll('.tt-withdraw').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const idx = parseInt(btn.getAttribute('data-idx'), 10);
                        const appsNow = JSON.parse(localStorage.getItem('TT_APPLICATIONS') || '[]');
                        if (!appsNow[idx]) return (window.ttFlash || alert)('Application not found');
                        const removed = appsNow.splice(idx, 1)[0];
                        localStorage.setItem('TT_APPLICATIONS', JSON.stringify(appsNow));
                        (window.ttFlash || alert)(`Withdrawn application: ${removed.title}`);
                        renderApps();
                    });
                });
            }
            renderApps();
        })();
    </script>
    <script src="../../js/main.js"></script>
</body>

</html>